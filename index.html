<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Tic Tac Toe</title>
  <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Open+Sans:wght@400;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0; padding: 0; box-sizing: border-box;
    }
    body {
      font-family: 'Open Sans', sans-serif;
      background: #0a0a0a;
      color: #fff;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 10px;
    }
    h1 {
      text-align: center;
      font-family: 'Pacifico', cursive;
      margin: 20px 0 10px;
      font-size: 2.5rem;
      color: #ffcc00;
    }
    .game-container {
      width: 100%;
      max-width: 420px;
      padding: 20px;
      background: #1c1c1c;
      border-radius: 15px;
      box-shadow: 0 0 20px #000;
    }
    .board {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin: 20px 0;
    }
    .box {
      width: 100%;
      aspect-ratio: 1 / 1;
      font-size: 2.5rem;
      font-weight: bold;
      background: #333;
      border: 2px solid #666;
      border-radius: 15px;
      cursor: pointer;
      color: #fff;
      transition: background 0.3s;
    }
    .box:active {
      background: #555;
    }
    .win-glow {
      background: #0f0 !important;
      color: #000;
    }
    .msg-Container {
      margin-top: 15px;
      font-size: 1.3rem;
      display: none;
      text-align: center;
    }
    .scoreboard, .controls {
      display: flex;
      justify-content: space-between;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 15px;
    }
    select, button, input {
      flex: 1;
      padding: 10px;
      font-size: 1rem;
      border: none;
      border-radius: 10px;
      background: #222;
      color: #fff;
    }
    button:hover {
      background: #444;
    }
    input::placeholder {
      color: #aaa;
    }
    #timer {
      text-align: center;
      margin: 10px 0;
    }
    #music-toggle {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: #222;
      color: #fff;
      border: none;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      font-size: 1.2rem;
      box-shadow: 0 0 10px #000;
    }

    @media (max-width: 500px) {
      h1 { font-size: 2rem; }
      .box { font-size: 2rem; }
    }
  </style>
</head>
<body>
  <h1>Tic Tac Toe</h1>
  <p>Every move counts. Play smart!</p>
  <p>Mark it. Block it. Win it.</p>
  <div class="game-container">
    <div class="controls">
      <select id="mode">
        <option value="cpu">Vs Computer</option>
        <option value="human">2 Players</option>
      </select>
      <select id="difficulty">
        <option value="easy">Easy</option>
        <option value="medium">Medium</option>
        <option value="hard">Hard</option>
      </select>
    </div>
    <div class="controls">
      <input type="text" id="playerXName" placeholder="Player X Name (Default: X)">
      <input type="text" id="playerOName" placeholder="Player O Name (Default: O)">
    </div>
    <div class="board">
      <button class="box"></button>
      <button class="box"></button>
      <button class="box"></button>
      <button class="box"></button>
      <button class="box"></button>
      <button class="box"></button>
      <button class="box"></button>
      <button class="box"></button>
      <button class="box"></button>
    </div>
    <div id="timer">Time Left: <span id="timeLeft">30</span>s</div>
    <div class="scoreboard">
      <div id="scoreX">X: 0</div>
      <div id="scoreO">O: 0</div>
    </div>
    <div class="msg-Container" id="msg"></div>
    <div class="controls">
      <button id="reset-btn">Reset</button>
      <button id="new-btn">New Game</button>
    </div>
  </div>

  <!-- Sound Effects -->
  <audio id="clickSound" src="https://www.soundjay.com/buttons/sounds/button-16.mp3"></audio>
  <audio id="winSound" src="https://www.soundjay.com/misc/sounds/bell-ringing-01.mp3"></audio>
  <audio id="drawSound" src="https://www.soundjay.com/button/sounds/beep-05.mp3"></audio>

  <!-- Background Music -->
  <audio id="bgMusic" src="bensound-sunny.mp3" loop></audio>
  <button id="music-toggle">ðŸŽµ</button>

  <script>
    const boxes = document.querySelectorAll(".box");
    const resetBtn = document.querySelector("#reset-btn");
    const newBtn = document.querySelector("#new-btn");
    const msgContainer = document.querySelector(".msg-Container");
    const msg = document.querySelector("#msg");
    const scoreO = document.querySelector("#scoreO");
    const scoreX = document.querySelector("#scoreX");
    const timer = document.querySelector("#timeLeft");

    const clickSound = document.getElementById("clickSound");
    const winSound = document.getElementById("winSound");
    const drawSound = document.getElementById("drawSound");
    const bgMusic = document.getElementById("bgMusic");
    const musicToggle = document.getElementById("music-toggle");

    const playerXNameInput = document.getElementById("playerXName");
    const playerONameInput = document.getElementById("playerOName");

    let currentPlayer = "X";
    let gameGrid = ["", "", "", "", "", "", "", "", ""];
    let scores = { X: 0, O: 0 };
    let gameOver = false;
    let vsCPU = true;
    let difficulty = "easy";
    let timerInterval;
    let timeLeft = 30;

    const winningPositions = [
      [0, 1, 2], [3, 4, 5], [6, 7, 8],
      [0, 3, 6], [1, 4, 7], [2, 5, 8],
      [0, 4, 8], [2, 4, 6]
    ];

    document.querySelector("#mode").addEventListener("change", (e) => {
      vsCPU = e.target.value === "cpu";
    });
    document.querySelector("#difficulty").addEventListener("change", (e) => {
      difficulty = e.target.value;
    });

    const getPlayerName = (symbol) => {
      return symbol === "X"
        ? playerXNameInput.value.trim() || "X"
        : playerONameInput.value.trim() || "O";
    };

    const startTimer = () => {
      clearInterval(timerInterval);
      timeLeft = 30;
      timer.textContent = timeLeft;
      timerInterval = setInterval(() => {
        timeLeft--;
        timer.textContent = timeLeft;
        if (timeLeft === 0) {
          clearInterval(timerInterval);
          changeTurn();
          if (vsCPU && currentPlayer === "O") computerMove();
          startTimer();
        }
      }, 1000);
    };

    const initGame = () => {
      gameGrid.fill("");
      boxes.forEach(box => {
        box.innerText = "";
        box.disabled = false;
        box.classList.remove("win-glow");
      });
      currentPlayer = "X";
      gameOver = false;
      msgContainer.style.display = "none";
      clearInterval(timerInterval);
      startTimer();
    };

    const checkWinner = () => {
      for (let pattern of winningPositions) {
        const [a, b, c] = pattern;
        if (gameGrid[a] && gameGrid[a] === gameGrid[b] && gameGrid[b] === gameGrid[c]) {
          boxes[a].classList.add("win-glow");
          boxes[b].classList.add("win-glow");
          boxes[c].classList.add("win-glow");
          showWinner(gameGrid[a]);
          return;
        }
      }
      if (!gameGrid.includes("")) {
        drawSound.play();
        msg.innerText = "It's a Draw!";
        msgContainer.style.display = "block";
        gameOver = true;
      }
    };

    const showWinner = (winner) => {
      const name = getPlayerName(winner);
      msg.innerText = `${name} Wins!`;
      msgContainer.style.display = "block";
      gameOver = true;
      winSound.play();
      scores[winner]++;
      scoreX.textContent = `X: ${scores.X}`;
      scoreO.textContent = `O: ${scores.O}`;
    };

    const changeTurn = () => currentPlayer = currentPlayer === "X" ? "O" : "X";

    const computerMove = () => {
      if (gameOver) return;
      let move;
      const emptyIndices = gameGrid.map((v, i) => v === "" ? i : null).filter(v => v !== null);
      if (difficulty === "easy") {
        move = emptyIndices[Math.floor(Math.random() * emptyIndices.length)];
      } else {
        move = emptyIndices[0]; // can add smarter AI here
      }
      setTimeout(() => handleClick(move), 500);
    };

    const handleClick = (index) => {
      if (gameGrid[index] !== "" || gameOver) return;
      gameGrid[index] = currentPlayer;
      boxes[index].innerText = currentPlayer;
      boxes[index].disabled = true;
      clickSound.play();
      checkWinner();
      if (!gameOver) {
        changeTurn();
        startTimer();
        if (vsCPU && currentPlayer === "O") computerMove();
      }
    };

    boxes.forEach((box, index) => box.addEventListener("click", () => handleClick(index)));
    resetBtn.addEventListener("click", initGame);
    newBtn.addEventListener("click", () => {
      scores = { X: 0, O: 0 };
      scoreX.textContent = "X: 0";
      scoreO.textContent = "O: 0";
      initGame();
    });

    musicToggle.addEventListener("click", () => {
      if (bgMusic.paused) {
        bgMusic.play();
        musicToggle.textContent = "ðŸ”Š";
      } else {
        bgMusic.pause();
        musicToggle.textContent = "ðŸŽµ";
      }
    });

    // Auto-play music on load (if allowed)
    window.addEventListener("load", () => {
      try { bgMusic.play(); musicToggle.textContent = "ðŸ”Š"; } catch(e) {}
    });

    initGame();
  </script>
</body>
</html>
